<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>Document</title>
	<style type="text/css">
		#submitbtn{
			width: 200px;
		}
	</style>
</head>
<body>
	<h1>欢迎给我留言</h1>
	<div>
		<p>姓名：<input type="text" id="xingming" /></p> 
		<p>QQ号码：<input type="text" id="qqhao" /></p>
		<p>内容：
			<textarea id="neirong" cols="30" rows="10"></textarea>
		</p>
		<p>
			<input type="button" value="提交留言" id="submitbtn"/>
		</p>
	</div>
	
	<script type="text/javascript" src="js/jquery-1.12.3.min.js"></script>
	<script type="text/javascript">
		$("#submitbtn").click(function(){
			
			$.post("control/write.php",{
				"xingming" 	: $("#xingming").val(),
				"qqhao" 	: $("#qqhao").val(),
				"neirong" 	: $("#neirong").val()
			},function(data){
				if(data.result == "ok"){
					alert("添加成功");
					clearInterval(timer);
					$this.html("提交留言");
				}else{
					alert("添加失败");
					clearInterval(timer);
					$this.html("提交留言");
				}
			});

			//美化业务
			var a = 0;
			$this = $(this);
			var timer = setInterval(function(){
				a++;
				if(a > 4){
					a = 0;
				}
				var str = (new Array(a)).join(".");
				$this.val("正在添加" + str);
			},250);
		});
	</script>
</body>
</html>