<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>携程在手·说走就走</title>
	<meta name=viewport content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
	<link rel="stylesheet" href="css/cssreset-min.css">
	<link rel="stylesheet" href="css/index.css">
</head>
<body>
	<header>
		<div class="soso_box">
			<input type="text" placeholder="搜索:目的地/酒店/景点/航班号">
		</div>
		<div class="user">
			<a onclick="javascript:window.location='#';">我  的</a>
		</div>
	</header>
	<!-- banner -->
	<section class="banner">
		<div class="imageList">
			<ul>
				<li><a href="#"><img src="images/banner0.jpg" alt=""></a></li>
				<li><a href="#"><img src="images/banner1.png" alt=""></a></li>
				<li><a href="#"><img src="images/banner2.jpg" alt=""></a></li>
				<li><a href="#"><img src="images/banner3.jpg" alt=""></a></li>
				<li><a href="#"><img src="images/banner4.jpg" alt=""></a></li>
				<li><a href="#"><img src="images/banner5.jpg" alt=""></a></li>
			</ul>
		</div>
	</section>

	<!-- 导航部分 -->
	<nav>
		<div class="row">
			<ul>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
			</ul>
		</div>
		<div class="row">
			<ul>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
			</ul>
		</div>
		<div class="row">
			<ul>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
			</ul>
		</div>
		<div class="row">
			<ul>
				<li><div><a href="#">机 票</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
				<li><div><a href="#">团 购</a></div></li>
			</ul>
		</div>
	</nav>
	<section class="products">
		<ul>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
		</ul>
	</section>

	<section class="temaihui">
		<div class="hd">
			<h3>特卖汇</h3>
			<div class="hongbao"><a href="">领红包再下单</a></div>
		</div>
		<div class="bd">
			<div class="baokuan_box sales_item">
				<div class="pic">
					<span>爆款</span>
					<img src="images/1225.jpg" alt="">
				</div>
				<h4>马来西亚槟城+兰卡威5日4晚半自助游(4钻)·【兰卡威自由活动】2799起限量</h4>
				<span class="price"><em>¥</em>2799</span>
				<span class="cut">4.7折</span>
			</div>
			<div class="sales_item">
				<dl>
					<dt>千款特价</dt>
					<dd>走过路过不错过</dd>
				</dl>
				<img src="images/pic-tmh-02.png" alt="">
			</div>
			<div class="sales_item">
				<dl>
					<dt>海外精选</dt>
					<dd><span>百元</span>出境游</dd>
				</dl>
			</div>
			<div class="sales_item">
				<dl>
					<dt>周边玩乐</dt>
					<dd><span>十元</span>度周末</dd>
				</dl>
			</div>
		</div>
	</section>

	<section class="huodong">
		<div class="hd">
			<h3>热门活动<i></i></h3>
			<div class="fuli"><a href="">获取更多福利 > </a></div>
		</div>
		<div class="bd">
			<ul>
				<li><a href="#"><img src="images/huodong1.png" alt=""></a></li>
				<li><a href="#"><img src="images/huodong2.png" alt=""></a></li>
				<li><a href="#"><img src="images/huodong3.png" alt=""></a></li>
				<li><a href="#"><img src="images/huodong4.jpg" alt=""></a></li>
				<li><a href="#"><img src="images/huodong5.png" alt=""></a></li>
			</ul>
		</div>
	</section>

	<section class="tool">
		<ul>
			<li><a href="">电话预定</a></li>
			<li><a href="">下载客户端</a></li>
			<li><a href="">我 的</a></li>
		</ul>
	</section>

	<footer>
		<p>
			<a href="#">网站地图</a> |
			<a href="#">ENGLIST</a> |
			<a href="#">电脑版</a>
		</p>
		<p class="copyright">
			&copy;2017携程旅行
		</p>
	</footer>

	<script type="text/javascript">
		//通过选择器得到元素们
		var banner = document.querySelector(".banner");
		//屏幕尺寸被改变的时候执行 
		window.onresize = set;

		set();

		function set(){
			//var windowWidth = document.documentElement.clientWidth;
			//盒子的计算后的宽度，找到0号盒子当代表，看看此时计算后的宽度是什么
			var windowWidth = document.documentElement.clientWidth;
			var bannerWidth = parseInt(getComputedStyle(banner)["width"]);
			//设置banner高度
			banner.style.height = bannerWidth / (1242 / 248) + "px";

			//设计师的实际图540宽，540状态下的font-size我们自己设置了一个15px。
			//所以当前的字号就要按比例来：
			// document.documentElement.style.fontSize = 15 * (windowWidth / 540) + "px";
		}

		//得到轮播图里面的li
		var imageLis = document.querySelectorAll(".banner .imageList li");

		//信号量
		var idx = 0;	//当前中间图片
		var next = 1;	//下一张
		var prev = 5;	//上一张

		var windowWidth;


		//初始化
		init();

		//屏幕尺寸改变重新执行初始化
		window.onresize = init;

		function init(){
			//屏幕的宽度
			windowWidth = document.documentElement.clientWidth;

			//设置li的默认位置
			for(var i = 1 ; i < imageLis.length ; i++){
				imageLis[i].style.webkitTransform = "translateX(" + windowWidth + "px)";
			}

			//去掉过渡，移动的时候我希望实时跟随鼠标，而不是有过渡效果
			imageLis[idx].style.transition = "none";
			imageLis[next].style.transition = "none";
			imageLis[prev].style.transition = "none";
			//新的位置
			imageLis[idx].style.webkitTransform = "translateX(0px)";
			imageLis[next].style.webkitTransform = "translateX(" + windowWidth + "px)";
			imageLis[prev].style.webkitTransform = "translateX(" + -windowWidth + "px)";
		}


		//事件监听
		banner.addEventListener("touchstart",touchstartHandler,false);
		banner.addEventListener("touchmove",touchmoveHandler,false);
		banner.addEventListener("touchend",touchendHandler,false);

		

		//手指的偏移量
		var deltaX;
		//触摸开始时候的手指位置
		var startX;
		//时间戳，从1970年1月1日0:00到现在的毫秒数
		var startTime;

		//定时器
		var timer = setInterval(function(){
			showNext();
		},4000);

		//事件处理函数
		function touchstartHandler(event){
			//阻止默认事件
			event.preventDefault();
			//手指个数
			if(event.touches.length > 1){
				return;
			}

			clearInterval(timer);
	
			//记录偏移量
			deltaX = event.touches[0].clientX;
			//记录手指位置
			startX = event.touches[0].clientX;
			//去掉过渡，移动的时候我希望实时跟随鼠标，而不是有过渡效果
			imageLis[idx].style.transition = "none";
			imageLis[next].style.transition = "none";
			imageLis[prev].style.transition = "none";
			//记录时间戳
			startTime = new Date();

			//就位（这个事儿没有必要，纯粹为了防穿帮）
			imageLis[idx].style.webkitTransform = "translateX(0px)";
			imageLis[next].style.webkitTransform = "translateX(" + windowWidth + "px)";
			imageLis[prev].style.webkitTransform = "translateX(" + -windowWidth + "px)";
		}
		//手指移动的时候
		function touchmoveHandler(event){
			//阻止默认事件
			event.preventDefault();
			//手指个数
			if(event.touches.length > 1){
				return;
			}
			//清除定时器
			clearInterval(timer);

			//得到坐标
			var clientX = event.touches[0].clientX;
			//改变图片的位置
			imageLis[idx].style.webkitTransform = "translateX(" + (clientX - deltaX) + "px)";
			imageLis[next].style.webkitTransform = "translateX(" + (windowWidth + clientX - deltaX) + "px)";
			imageLis[prev].style.webkitTransform = "translateX(" + (-windowWidth + clientX - deltaX) + "px)";
		}
		//手指结束触摸的时候
		function touchendHandler(event){
			//阻止默认事件
			event.preventDefault();

			//决断滑动是否成功
			var distance = event.changedTouches[0].clientX - startX;
			//滑动的时间
			var time = new Date() - startTime;

			//如果你像右边滑动超过了屏幕的一半，或者你向右边滑动且时间小于500，就认为滑动成功
			if(distance >= windowWidth / 2 || (distance > 30 && time < 300)){
				//向右边滑动成功
				//先改变信号量
				next = idx;
				idx = prev;
				//改变next
				prev--;
				if(prev < 0){
					prev = 4;
				}

				//加上过渡
				imageLis[idx].style.transition = "all 0.3s ease 0s";
				imageLis[next].style.transition = "all 0.3s ease 0s";
				//移动
				imageLis[idx].style.webkitTransform = "translateX(0px)";
				imageLis[next].style.webkitTransform = "translateX(" + windowWidth + "px)";

			}else if(distance <= -windowWidth / 2 || (distance < -30 && time < 300)){
				showNext();
			}else{
				//绝对值不到windowWidth/2，  滑动不成功
				console.log("不成功");

				//加上过渡
				imageLis[prev].style.transition = "all 0.3s ease 0s";
				imageLis[idx].style.transition = "all 0.3s ease 0s";
				imageLis[next].style.transition = "all 0.3s ease 0s";

				//移动
				imageLis[prev].style.webkitTransform = "translateX(" + -windowWidth + "px)";
				imageLis[idx].style.webkitTransform = "translateX(0px)";
				imageLis[next].style.webkitTransform = "translateX(" + windowWidth + "px)";
			}

			clearInterval(timer);
			//开始定时器
			timer = setInterval(function(){
				showNext();
			},4000);
		}

		function showNext(){
			//向左边滑动成功
			//先改变信号量
			prev = idx;
			idx = next;
			//改变next
			next++;
			if(next > 4){
				next = 0;
			}

			//加上过渡
			imageLis[prev].style.transition = "all 0.3s ease 0s";
			imageLis[idx].style.transition = "all 0.3s ease 0s";
			//移动
			imageLis[prev].style.webkitTransform = "translateX(" + -windowWidth + "px)";
			imageLis[idx].style.webkitTransform = "translateX(0px)";
		}
	</script>
</body>
</html>